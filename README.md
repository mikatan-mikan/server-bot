## 用途

mc serverをdiscord上から操作する用途。

プログラムに含まれるコマンドは以下の通りです。

|コマンド|実行結果|
----|----
|help|discord上にhelpを表示します。|
|start|サーバーを開始します。但し、server.py起動時には自動的に開始されます。|
|stop|サーバーを停止します。但しserver.pyは実行状態から遷移しないため他のコマンドを使用できます。|
|exit|server.pyを終了します。サーバー停止中にのみ使用できます。|
|backup|サーバーデータをバックアップします。引数が与えられない場合`./worlds`をバックアップします。|
|cmd|マインクラフトサーバーに対してコマンドを送信します。|
|replace|server.pyを与えられた引数に置換します。このコマンドの実行には管理者権限が必要です。|

## 動作確認

統合版 dedicated server にて動作確認をしています。

java版でも恐らく使えるはず。。。

### 確認済み環境

os : windows 11 version 23H2

lang : python3.12.2

## 必要なもの

現在使用していないdiscord bot

### ライブラリ

requirements.txtを参照

## 使用方法

server.pyをサーバー本体(exeまたはjar)と同階層に配置します。

この時、server.pyが存在する階層はrootでない必要があります。(何かのディレクトリの中に入れてください)これは、`../backup/`内にbackupが生成されるためです。

server.pyを開き`server_name = "bedrock_server.exe"`の`"bedrock_server.exe"`を自身のサーバーファイル名に変更します。

後にserver.pyを起動すると`./.token`が生成されるので、ここにbotのtokenを記述してください。

このとき同時に`update.py`が生成されますが、これは`/repalce`を実行するために必要なファイルです。

token記述後にカレントディレクトリとserver.py/server.[exe/jar]が存在する階層が同じ状態で再度server.pyを起動すると正常に起動するはずです。このプログラムはserver.pyがサーバー本体を呼び出すためserver.[exe/jar]を自身で起動する必要はありません。

## 注意

このbotは見知らぬプレイヤーが多くいる状況下での使用を推奨していません。もしもそのような状況下で利用したい場合にはほとんどのコマンドに管理者権限のチェックを実装する必要があるでしょう。(但し誰でもコマンドを実行できる環境は後に改善する予定があります。)

但し現在のところサーバー管理者のみのdiscord サーバーに導入する方法をとればこれらは解決できます。

またserver.pyと生成されるupdate.pyの名前は変更しないでください。`/replace`が動作しなくなるはずです。

### /cmd

このコマンドで利用できるコマンドは`allow_cmd`により定義されています。他に使いたいコマンドが存在する場合はlistを追加してください。

コマンド使用例としてwhitelistへの追加は/cmd `command:whitelist add <mcid>`のようにして実行できます。

### /exit

このコマンドを実行すると次回サーバー管理者がserver.pyを実行するまで他のコマンドを使用できません。

## 免責事項

本プログラムのインストール/実行/その他本プログラムが影響する挙動全てにおいて、生じた損害や不具合には作者は一切の責任を負わないものとします。